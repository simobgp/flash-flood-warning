<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIVE Flash Flood Warning Tracker | US Radar & Real-Time Map</title>
    <meta name="description" content="Track live Flash Flood Warnings with our interactive US radar map. Real-time NWS alerts, state-by-state flood counts, and emergency safety guides. Update every 60 seconds.">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --danger: #e11d48; --warning: #f59e0b; --dark: #0f172a; --live: #22c55e; --slate: #f1f5f9; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; background: var(--slate); color: var(--dark); }

        /* Dashboard Header */
        .top-nav { background: #fff; border-bottom: 2px solid #e2e8f0; padding: 10px 0; sticky; top: 0; z-index: 1000; }
        .flex-row { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .logo { font-weight: 900; color: var(--danger); font-size: 1.5rem; text-decoration: none; }
        
        /* Live Command Center */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        .stat-card { background: #fff; padding: 20px; border-radius: 12px; border: 1px solid #e2e8f0; text-align: center; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .stat-number { display: block; font-size: 2.5rem; font-weight: 800; color: var(--danger); }
        .stat-label { font-size: 0.8rem; font-weight: 700; text-transform: uppercase; color: #64748b; }
        .live-dot { height: 10px; width: 10px; background: var(--live); border-radius: 50%; display: inline-block; margin-right: 5px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }

        /* Map & Controls */
        .main-container { max-width: 1200px; margin: 0 auto; padding: 20px; display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
        #ffw-map { height: 550px; background: #fff; border-radius: 16px; border: 1px solid #e2e8f0; z-index: 1; }
        .sidebar { background: #fff; border-radius: 16px; border: 1px solid #e2e8f0; padding: 20px; height: 550px; display: flex; flex-direction: column; }
        .alert-item { background: var(--slate); padding: 12px; border-radius: 8px; margin-bottom: 10px; border-left: 5px solid var(--danger); font-size: 0.85rem; }

        /* Search & SEO Content */
        .search-bar { background: var(--dark); padding: 40px 0; color: #fff; text-align: center; }
        .search-box { background: #fff; padding: 8px; border-radius: 50px; display: flex; max-width: 500px; margin: 20px auto; border: 4px solid rgba(255,255,255,0.2); }
        .search-box input { flex: 1; border: none; padding-left: 20px; border-radius: 50px; outline: none; font-size: 1rem; }
        .search-box button { background: var(--danger); color: #fff; border: none; padding: 10px 25px; border-radius: 50px; font-weight: bold; cursor: pointer; }

        .seo-content { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
        .faq-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .faq-item { background: #fff; padding: 20px; border-radius: 12px; }

        /* Ad Slots */
        .ad-slot { background: #e2e8f0; height: 90px; margin: 20px 0; display: flex; align-items: center; justify-content: center; color: #94a3b8; border: 1px dashed #cbd5e1; border-radius: 8px; }

        @media (max-width: 900px) { .main-container { grid-template-columns: 1fr; } .faq-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="top-nav">
    <div class="flex-row">
        <a href="#" class="logo">FLASH FLOOD TRACKER</a>
        <div style="font-size: 0.8rem; font-weight: bold; color: var(--live);">
            <span class="live-dot"></span> LIVE NWS API CONNECTION
        </div>
    </div>
</div>

<section class="search-bar">
    <div class="container">
        <h1>Local Flash Flood Alerts Near Me</h1>
        <p>Real-time Doppler radar and emergency data for every US county.</p>
        <div class="search-box">
            <input type="text" id="locInput" placeholder="Enter City, State, or Zip...">
            <button onclick="searchLoc()">SEARCH</button>
        </div>
    </div>
</section>

<div class="dashboard-grid">
    <div class="stat-card">
        <span class="stat-number" id="count-warn">0</span>
        <span class="stat-label">Active Warnings</span>
    </div>
    <div class="stat-card">
        <span class="stat-number" id="count-states">0</span>
        <span class="stat-label">States Affected</span>
    </div>
    <div class="stat-card">
        <span class="stat-number" id="last-update" style="font-size: 1.5rem; margin: 15px 0;">--:--</span>
        <span class="stat-label">Last Updated</span>
    </div>
    <div class="stat-card">
        <span class="stat-number" id="timer" style="font-size: 1.5rem; margin: 15px 0; color: var(--warning);">00:59</span>
        <span class="stat-label">Next Refresh</span>
    </div>
</div>

<div class="container ad-slot">-- Top AdSense Leaderboard --</div>

<main class="main-container">
    <div id="ffw-map"></div>
    
    <aside class="sidebar">
        <h3 style="margin-bottom: 15px;">Live Alert Stream</h3>
        <div id="alert-feed" style="overflow-y: auto; flex-grow: 1;">
            <p style="color: #64748b;">Waiting for NWS data...</p>
        </div>
        <div class="ad-slot" style="height: 150px; margin-bottom: 0;">-- Sidebar Ad --</div>
    </aside>
</main>

<section class="seo-content">
    <h2 style="margin-bottom: 25px;">Expert Flood Safety Guide</h2>
    <div class="faq-grid">
        <div class="faq-item">
            <h3>üè† Is my house in a flood zone?</h3>
            <p>Flash floods can occur anywhere it rains heavily. Even if you are not in a FEMA flood zone, localized "pluvial" flooding can occur in urban areas due to concrete runoff.</p>
        </div>
        <div class="faq-item">
            <h3>üöó Why "Turn Around Don't Drown"?</h3>
            <p>Over 50% of flood-related deaths occur in vehicles. It only takes 12 inches of rushing water to carry away a small car. Never drive through water-covered roads.</p>
        </div>
    </div>
    
    <div class="ad-slot">-- Mid-Content Ad Unit --</div>

    <div class="faq-grid" style="margin-top: 20px;">
        <div class="faq-item">
            <h3>‚ö†Ô∏è Flood Watch vs Warning</h3>
            <p>A <strong>Watch</strong> means conditions are favorable for flooding‚Äîstay alert. A <strong>Warning</strong> means a flash flood is happening now or is imminent‚Äîmove to higher ground immediately.</p>
        </div>
        <div class="faq-item">
            <h3>üåä Water Damage & Restoration</h3>
            <p>After a flood, contact a professional water cleanup team immediately. Mold can begin growing within 24 to 48 hours of water exposure.</p>
        </div>
    </div>
</section>

<footer>
    <div class="flex-row" style="flex-wrap: wrap; gap: 40px; padding: 60px 20px; background: var(--dark); color: #94a3b8; margin-top: 40px;">
        <div style="flex: 2;">
            <h4 style="color:#fff;">Flash Flood Tracker Portal</h4>
            <p>Our mission is to provide 24/7 public access to critical National Weather Service data to prevent loss of life and property damage.</p>
        </div>
        <div style="flex: 1;">
            <h4 style="color:#fff;">Quick Links</h4>
            <a href="#" style="color:#fff; text-decoration:none;">Privacy Policy</a><br>
            <a href="#" style="color:#fff; text-decoration:none;">Contact Us</a><br>
            <a href="https://www.weather.gov" style="color:#fff; text-decoration:none;">NWS Official Site</a>
        </div>
    </div>
</footer>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const map = L.map('ffw-map').setView([39.8, -98.5], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    const alertLayer = L.layerGroup().addTo(map);

    let refreshSec = 60;

    async function getNWSAlerts() {
        try {
            const res = await fetch('https://api.weather.gov/alerts/active?event=Flash%20Flood%20Warning,Flash%20Flood%20Watch');
            const data = await res.json();
            
            alertLayer.clearLayers();
            const feed = document.getElementById('alert-feed');
            feed.innerHTML = "";
            
            let warnings = 0;
            let states = new Set();

            if (data.features && data.features.length > 0) {
                L.geoJSON(data, {
                    style: (f) => ({ color: f.properties.event.includes('Warning') ? '#e11d48' : '#f59e0b', weight: 4, fillOpacity: 0.5 }),
                    onEachFeature: (f, l) => {
                        l.bindPopup(`<strong>${f.properties.event}</strong><br>${f.properties.areaDesc}<br><br><em>${f.properties.instruction || ""}</em>`);
                    }
                }).addTo(alertLayer);

                data.features.forEach(f => {
                    if(f.properties.event.includes('Warning')) warnings++;
                    
                    // Count states
                    const area = f.properties.areaDesc;
                    const stateCode = area.match(/([A-Z]{2})/);
                    if(stateCode) states.add(stateCode[0]);

                    // Add to sidebar
                    const item = document.createElement('div');
                    item.className = 'alert-item';
                    item.innerHTML = `<strong>${f.properties.event}</strong><br>${f.properties.areaDesc.split(';')[0]}`;
                    item.onclick = () => {
                        const c = f.geometry.coordinates[0][0];
                        map.flyTo([c[1], c[0]], 10);
                    };
                    feed.appendChild(item);
                });
            } else {
                feed.innerHTML = "<p>No active flash flood alerts in the US.</p>";
            }

            document.getElementById('count-warn').innerText = warnings;
            document.getElementById('count-states').innerText = states.size;
            document.getElementById('last-update').innerText = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            refreshSec = 60;
        } catch (e) {
            console.error("API Error");
        }
    }

    // Timer Logic
    setInterval(() => {
        refreshSec--;
        if(refreshSec < 0) {
            getNWSAlerts();
            refreshSec = 60;
        }
        document.getElementById('timer').innerText = `00:${refreshSec < 10 ? '0' : ''}${refreshSec}`;
    }, 1000);

    function searchLoc() {
        const val = document.getElementById('locInput').value;
        if(val) {
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${val}&countrycodes=us`)
            .then(r => r.json()).then(d => { if(d[0]) map.flyTo([d[0].lat, d[0].lon], 11); });
        }
    }

    window.onload = getNWSAlerts;
</script>

</body>
</html>
